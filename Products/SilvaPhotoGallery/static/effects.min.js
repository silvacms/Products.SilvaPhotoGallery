String.prototype.parseColor=function(){var e="#";if(this.slice(0,4)=="rgb("){var t=this.slice(4,this.length-1).split(","),n=0;do e+=parseInt(t[n]).toColorPart();while(++n<3)}else if(this.slice(0,1)=="#"){if(this.length==4)for(var n=1;n<4;n++)e+=(this.charAt(n)+this.charAt(n)).toLowerCase();this.length==7&&(e=this.toLowerCase())}return e.length==7?e:arguments[0]||this},Element.collectTextNodes=function(e){return $A($(e).childNodes).collect(function(e){return e.nodeType==3?e.nodeValue:e.hasChildNodes()?Element.collectTextNodes(e):""}).flatten().join("")},Element.collectTextNodesIgnoreClass=function(e,t){return $A($(e).childNodes).collect(function(e){return e.nodeType==3?e.nodeValue:e.hasChildNodes()&&!Element.hasClassName(e,t)?Element.collectTextNodes(e):""}).flatten().join("")},Element.setStyle=function(e,t){e=$(e);for(k in t)e.style[k.camelize()]=t[k]},Element.setContentZoom=function(e,t){Element.setStyle(e,{fontSize:t/100+"em"}),navigator.appVersion.indexOf("AppleWebKit")>0&&window.scrollBy(0,0)},Element.getOpacity=function(e){var t;if(t=Element.getStyle(e,"opacity"))return parseFloat(t);if(t=(Element.getStyle(e,"filter")||"").match(/alpha\(opacity=(.*)\)/))if(t[1])return parseFloat(t[1])/100;return 1},Element.setOpacity=function(e,t){e=$(e),t==1?(Element.setStyle(e,{opacity:/Gecko/.test(navigator.userAgent)&&!/Konqueror|Safari|KHTML/.test(navigator.userAgent)?.999999:null}),/MSIE/.test(navigator.userAgent)&&Element.setStyle(e,{filter:Element.getStyle(e,"filter").replace(/alpha\([^\)]*\)/gi,"")})):(t<1e-5&&(t=0),Element.setStyle(e,{opacity:t}),/MSIE/.test(navigator.userAgent)&&Element.setStyle(e,{filter:Element.getStyle(e,"filter").replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+t*100+")"}))},Element.getInlineOpacity=function(e){return $(e).style.opacity||""},Element.childrenWithClassName=function(e,t){return $A($(e).getElementsByTagName("*")).select(function(e){return Element.hasClassName(e,t)})},Array.prototype.call=function(){var e=arguments;this.each(function(t){t.apply(this,e)})};var Effect={tagifyText:function(e){var t="position:relative";/MSIE/.test(navigator.userAgent)&&(t+=";zoom:1"),e=$(e),$A(e.childNodes).each(function(n){n.nodeType==3&&(n.nodeValue.toArray().each(function(r){e.insertBefore(Builder.node("span",{style:t},r==" "?String.fromCharCode(160):r),n)}),Element.remove(n))})},multiple:function(e,t){var n;typeof e!="object"&&typeof e!="function"||!e.length?n=$(e).childNodes:n=e;var r=Object.extend({speed:.1,delay:0},arguments[2]||{}),i=r.delay;$A(n).each(function(e,n){new t(e,Object.extend(r,{delay:n*r.speed+i}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(e,t){e=$(e),t=(t||"appear").toLowerCase();var n=Object.extend({queue:{position:"end",scope:e.id||"global"}},arguments[2]||{});Effect[Element.visible(e)?Effect.PAIRS[t][1]:Effect.PAIRS[t][0]](e,n)}},Effect2=Effect;Effect.Transitions={},Effect.Transitions.linear=function(e){return e},Effect.Transitions.sinoidal=function(e){return-Math.cos(e*Math.PI)/2+.5},Effect.Transitions.reverse=function(e){return 1-e},Effect.Transitions.flicker=function(e){return-Math.cos(e*Math.PI)/4+.75+Math.random()/4},Effect.Transitions.wobble=function(e){return-Math.cos(e*Math.PI*9*e)/2+.5},Effect.Transitions.pulse=function(e){return Math.floor(e*10)%2==0?e*10-Math.floor(e*10):1-(e*10-Math.floor(e*10))},Effect.Transitions.none=function(e){return 0},Effect.Transitions.full=function(e){return 1},Effect.ScopedQueue=Class.create(),Object.extend(Object.extend(Effect.ScopedQueue.prototype,Enumerable),{initialize:function(){this.effects=[],this.interval=null},_each:function(e){this.effects._each(e)},add:function(e){var t=(new Date).getTime(),n=typeof e.options.queue=="string"?e.options.queue:e.options.queue.position;switch(n){case"front":this.effects.findAll(function(e){return e.state=="idle"}).each(function(t){t.startOn+=e.finishOn,t.finishOn+=e.finishOn});break;case"end":t=this.effects.pluck("finishOn").max()||t}e.startOn+=t,e.finishOn+=t,this.effects.push(e),this.interval||(this.interval=setInterval(this.loop.bind(this),40))},remove:function(e){this.effects=this.effects.reject(function(t){return t==e}),this.effects.length==0&&(clearInterval(this.interval),this.interval=null)},loop:function(){var e=(new Date).getTime();this.effects.invoke("loop",e)}}),Effect.Queues={instances:$H(),get:function(e){return typeof e!="string"?e:(this.instances[e]||(this.instances[e]=new Effect.ScopedQueue),this.instances[e])}},Effect.Queue=Effect.Queues.get("global"),Effect.DefaultOptions={transition:Effect.Transitions.sinoidal,duration:1,fps:25,sync:!1,from:0,to:1,delay:0,queue:"parallel"},Effect.Base=function(){},Effect.Base.prototype={position:null,start:function(e){this.options=Object.extend(Object.extend({},Effect.DefaultOptions),e||{}),this.currentFrame=0,this.state="idle",this.startOn=this.options.delay*1e3,this.finishOn=this.startOn+this.options.duration*1e3,this.event("beforeStart"),this.options.sync||Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).add(this)},loop:function(e){if(e>=this.startOn){if(e>=this.finishOn){this.render(1),this.cancel(),this.event("beforeFinish"),this.finish&&this.finish(),this.event("afterFinish");return}var t=(e-this.startOn)/(this.finishOn-this.startOn),n=Math.round(t*this.options.fps*this.options.duration);n>this.currentFrame&&(this.render(t),this.currentFrame=n)}},render:function(e){this.state=="idle"&&(this.state="running",this.event("beforeSetup"),this.setup&&this.setup(),this.event("afterSetup")),this.state=="running"&&(this.options.transition&&(e=this.options.transition(e)),e*=this.options.to-this.options.from,e+=this.options.from,this.position=e,this.event("beforeUpdate"),this.update&&this.update(e),this.event("afterUpdate"))},cancel:function(){this.options.sync||Effect.Queues.get(typeof this.options.queue=="string"?"global":this.options.queue.scope).remove(this),this.state="finished"},event:function(e){this.options[e+"Internal"]&&this.options[e+"Internal"](this),this.options[e]&&this.options[e](this)},inspect:function(){return"#<Effect:"+$H(this).inspect()+",options:"+$H(this.options).inspect()+">"}},Effect.Parallel=Class.create(),Object.extend(Object.extend(Effect.Parallel.prototype,Effect.Base.prototype),{initialize:function(e){this.effects=e||[],this.start(arguments[1])},update:function(e){this.effects.invoke("render",e)},finish:function(e){this.effects.each(function(t){t.render(1),t.cancel(),t.event("beforeFinish"),t.finish&&t.finish(e),t.event("afterFinish")})}}),Effect.Opacity=Class.create(),Object.extend(Object.extend(Effect.Opacity.prototype,Effect.Base.prototype),{initialize:function(e){this.element=$(e),/MSIE/.test(navigator.userAgent)&&!this.element.hasLayout&&Element.setStyle(this.element,{zoom:1});var t=Object.extend({from:Element.getOpacity(this.element)||0,to:1},arguments[1]||{});this.start(t)},update:function(e){Element.setOpacity(this.element,e)}}),Effect.Move=Class.create(),Object.extend(Object.extend(Effect.Move.prototype,Effect.Base.prototype),{initialize:function(e){this.element=$(e);var t=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(t)},setup:function(){Element.makePositioned(this.element),this.originalLeft=parseFloat(Element.getStyle(this.element,"left")||"0"),this.originalTop=parseFloat(Element.getStyle(this.element,"top")||"0"),this.options.mode=="absolute"&&(this.options.x=this.options.x-this.originalLeft,this.options.y=this.options.y-this.originalTop)},update:function(e){Element.setStyle(this.element,{left:this.options.x*e+this.originalLeft+"px",top:this.options.y*e+this.originalTop+"px"})}}),Effect.MoveBy=function(e,t,n){return new Effect.Move(e,Object.extend({x:n,y:t},arguments[3]||{}))},Effect.Scale=Class.create(),Object.extend(Object.extend(Effect.Scale.prototype,Effect.Base.prototype),{initialize:function(e,t){this.element=$(e);var n=Object.extend({scaleX:!0,scaleY:!0,scaleContent:!0,scaleFromCenter:!1,scaleMode:"box",scaleFrom:100,scaleTo:t},arguments[2]||{});this.start(n)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||!1,this.elementPositioning=Element.getStyle(this.element,"position"),this.originalStyle={},["top","left","width","height","fontSize"].each(function(e){this.originalStyle[e]=this.element.style[e]}.bind(this)),this.originalTop=this.element.offsetTop,this.originalLeft=this.element.offsetLeft;var e=Element.getStyle(this.element,"font-size")||"100%";["em","px","%"].each(function(t){e.indexOf(t)>0&&(this.fontSize=parseFloat(e),this.fontSizeType=t)}.bind(this)),this.factor=(this.options.scaleTo-this.options.scaleFrom)/100,this.dims=null,this.options.scaleMode=="box"&&(this.dims=[this.element.offsetHeight,this.element.offsetWidth]),/^content/.test(this.options.scaleMode)&&(this.dims=[this.element.scrollHeight,this.element.scrollWidth]),this.dims||(this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth])},update:function(e){var t=this.options.scaleFrom/100+this.factor*e;this.options.scaleContent&&this.fontSize&&Element.setStyle(this.element,{fontSize:this.fontSize*t+this.fontSizeType}),this.setDimensions(this.dims[0]*t,this.dims[1]*t)},finish:function(e){this.restoreAfterFinish&&Element.setStyle(this.element,this.originalStyle)},setDimensions:function(e,t){var n={};this.options.scaleX&&(n.width=t+"px"),this.options.scaleY&&(n.height=e+"px");if(this.options.scaleFromCenter){var r=(e-this.dims[0])/2,i=(t-this.dims[1])/2;this.elementPositioning=="absolute"?(this.options.scaleY&&(n.top=this.originalTop-r+"px"),this.options.scaleX&&(n.left=this.originalLeft-i+"px")):(this.options.scaleY&&(n.top=-r+"px"),this.options.scaleX&&(n.left=-i+"px"))}Element.setStyle(this.element,n)}}),Effect.Highlight=Class.create(),Object.extend(Object.extend(Effect.Highlight.prototype,Effect.Base.prototype),{initialize:function(e){this.element=$(e);var t=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(t)},setup:function(){if(Element.getStyle(this.element,"display")=="none"){this.cancel();return}this.oldStyle={backgroundImage:Element.getStyle(this.element,"background-image")},Element.setStyle(this.element,{backgroundImage:"none"}),this.options.endcolor||(this.options.endcolor=Element.getStyle(this.element,"background-color").parseColor("#ffffff")),this.options.restorecolor||(this.options.restorecolor=Element.getStyle(this.element,"background-color")),this._base=$R(0,2).map(function(e){return parseInt(this.options.startcolor.slice(e*2+1,e*2+3),16)}.bind(this)),this._delta=$R(0,2).map(function(e){return parseInt(this.options.endcolor.slice(e*2+1,e*2+3),16)-this._base[e]}.bind(this))},update:function(e){Element.setStyle(this.element,{backgroundColor:$R(0,2).inject("#",function(t,n,r){return t+Math.round(this._base[r]+this._delta[r]*e).toColorPart()}.bind(this))})},finish:function(){Element.setStyle(this.element,Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}}),Effect.ScrollTo=Class.create(),Object.extend(Object.extend(Effect.ScrollTo.prototype,Effect.Base.prototype),{initialize:function(e){this.element=$(e),this.start(arguments[1]||{})},setup:function(){Position.prepare();var e=Position.cumulativeOffset(this.element);this.options.offset&&(e[1]+=this.options.offset);var t=window.innerHeight?window.height-window.innerHeight:document.body.scrollHeight-(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight);this.scrollStart=Position.deltaY,this.delta=(e[1]>t?t:e[1])-this.scrollStart},update:function(e){Position.prepare(),window.scrollTo(Position.deltaX,this.scrollStart+e*this.delta)}}),Effect.Fade=function(element){var oldOpacity=Element.getInlineOpacity(element),options=Object.extend({from:Element.getOpacity(element)||1,to:0,afterFinishInternal:function(effect){with(Element){if(effect.options.to!=0)return;hide(effect.element),setStyle(effect.element,{opacity:oldOpacity})}}},arguments[1]||{});return new Effect.Opacity(element,options)},Effect.Appear=function(element){var options=Object.extend({from:Element.getStyle(element,"display")=="none"?0:Element.getOpacity(element)||0,to:1,beforeSetup:function(effect){with(Element)setOpacity(effect.element,effect.options.from),show(effect.element)}},arguments[1]||{});return new Effect.Opacity(element,options)},Effect.Puff=function(element){element=$(element);var oldStyle={opacity:Element.getInlineOpacity(element),position:Element.getStyle(element,"position")};return new Effect.Parallel([new Effect.Scale(element,200,{sync:!0,scaleFromCenter:!0,scaleContent:!0,restoreAfterFinish:!0}),new Effect.Opacity(element,{sync:!0,to:0})],Object.extend({duration:1,beforeSetupInternal:function(effect){with(Element)setStyle(effect.effects[0].element,{position:"absolute"})},afterFinishInternal:function(effect){with(Element)hide(effect.effects[0].element),setStyle(effect.effects[0].element,oldStyle)}},arguments[1]||{}))},Effect.BlindUp=function(element){return element=$(element),Element.makeClipping(element),new Effect.Scale(element,0,Object.extend({scaleContent:!1,scaleX:!1,restoreAfterFinish:!0,afterFinishInternal:function(effect){with(Element)[hide,undoClipping].call(effect.element)}},arguments[1]||{}))},Effect.BlindDown=function(element){element=$(element);var oldHeight=Element.getStyle(element,"height"),elementDimensions=Element.getDimensions(element);return new Effect.Scale(element,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:!0,afterSetup:function(effect){with(Element)makeClipping(effect.element),setStyle(effect.element,{height:"0px"}),show(effect.element)},afterFinishInternal:function(effect){with(Element)undoClipping(effect.element),setStyle(effect.element,{height:oldHeight})}},arguments[1]||{}))},Effect.SwitchOff=function(element){element=$(element);var oldOpacity=Element.getInlineOpacity(element);return new Effect.Appear(element,{duration:.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(effect){new Effect.Scale(effect.element,1,{duration:.3,scaleFromCenter:!0,scaleX:!1,scaleContent:!1,restoreAfterFinish:!0,beforeSetup:function(effect){with(Element)[makePositioned,makeClipping].call(effect.element)},afterFinishInternal:function(effect){with(Element)[hide,undoClipping,undoPositioned].call(effect.element),setStyle(effect.element,{opacity:oldOpacity})}})}})},Effect.DropOut=function(element){element=$(element);var oldStyle={top:Element.getStyle(element,"top"),left:Element.getStyle(element,"left"),opacity:Element.getInlineOpacity(element)};return new Effect.Parallel([new Effect.Move(element,{x:0,y:100,sync:!0}),new Effect.Opacity(element,{sync:!0,to:0})],Object.extend({duration:.5,beforeSetup:function(effect){with(Element)makePositioned(effect.effects[0].element)},afterFinishInternal:function(effect){with(Element)[hide,undoPositioned].call(effect.effects[0].element),setStyle(effect.effects[0].element,oldStyle)}},arguments[1]||{}))},Effect.Shake=function(element){element=$(element);var oldStyle={top:Element.getStyle(element,"top"),left:Element.getStyle(element,"left")};return new Effect.Move(element,{x:20,y:0,duration:.05,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-40,y:0,duration:.1,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:40,y:0,duration:.1,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-40,y:0,duration:.1,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:40,y:0,duration:.1,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-20,y:0,duration:.05,afterFinishInternal:function(effect){with(Element)undoPositioned(effect.element),setStyle(effect.element,oldStyle)}})}})}})}})}})}})},Effect.SlideDown=function(element){element=$(element),Element.cleanWhitespace(element);var oldInnerBottom=Element.getStyle(element.firstChild,"bottom"),elementDimensions=Element.getDimensions(element);return new Effect.Scale(element,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:!0,afterSetup:function(effect){with(Element)makePositioned(effect.element),makePositioned(effect.element.firstChild),window.opera&&setStyle(effect.element,{top:""}),makeClipping(effect.element),setStyle(effect.element,{height:"0px"}),show(element)},afterUpdateInternal:function(effect){with(Element)setStyle(effect.element.firstChild,{bottom:effect.dims[0]-effect.element.clientHeight+"px"})},afterFinishInternal:function(effect){with(Element)undoClipping(effect.element),undoPositioned(effect.element.firstChild),undoPositioned(effect.element),setStyle(effect.element.firstChild,{bottom:oldInnerBottom})}},arguments[1]||{}))},Effect.SlideUp=function(element){element=$(element),Element.cleanWhitespace(element);var oldInnerBottom=Element.getStyle(element.firstChild,"bottom");return new Effect.Scale(element,0,Object.extend({scaleContent:!1,scaleX:!1,scaleMode:"box",scaleFrom:100,restoreAfterFinish:!0,beforeStartInternal:function(effect){with(Element)makePositioned(effect.element),makePositioned(effect.element.firstChild),window.opera&&setStyle(effect.element,{top:""}),makeClipping(effect.element),show(element)},afterUpdateInternal:function(effect){with(Element)setStyle(effect.element.firstChild,{bottom:effect.dims[0]-effect.element.clientHeight+"px"})},afterFinishInternal:function(effect){with(Element)[hide,undoClipping].call(effect.element),undoPositioned(effect.element.firstChild),undoPositioned(effect.element),setStyle(effect.element.firstChild,{bottom:oldInnerBottom})}},arguments[1]||{}))},Effect.Squish=function(element){return new Effect.Scale(element,window.opera?1:0,{restoreAfterFinish:!0,beforeSetup:function(effect){with(Element)makeClipping(effect.element)},afterFinishInternal:function(effect){with(Element)hide(effect.element),undoClipping(effect.element)}})},Effect.Grow=function(element){element=$(element);var options=Object.extend({direction:"center",moveTransistion:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{}),oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:Element.getInlineOpacity(element)},dims=Element.getDimensions(element),initialMoveX,initialMoveY,moveX,moveY;switch(options.direction){case"top-left":initialMoveX=initialMoveY=moveX=moveY=0;break;case"top-right":initialMoveX=dims.width,initialMoveY=moveY=0,moveX=-dims.width;break;case"bottom-left":initialMoveX=moveX=0,initialMoveY=dims.height,moveY=-dims.height;break;case"bottom-right":initialMoveX=dims.width,initialMoveY=dims.height,moveX=-dims.width,moveY=-dims.height;break;case"center":initialMoveX=dims.width/2,initialMoveY=dims.height/2,moveX=-dims.width/2,moveY=-dims.height/2}return new Effect.Move(element,{x:initialMoveX,y:initialMoveY,duration:.01,beforeSetup:function(effect){with(Element)hide(effect.element),makeClipping(effect.element),makePositioned(effect.element)},afterFinishInternal:function(effect){new Effect.Parallel([new Effect.Opacity(effect.element,{sync:!0,to:1,from:0,transition:options.opacityTransition}),new Effect.Move(effect.element,{x:moveX,y:moveY,sync:!0,transition:options.moveTransition}),new Effect.Scale(effect.element,100,{scaleMode:{originalHeight:dims.height,originalWidth:dims.width},sync:!0,scaleFrom:window.opera?1:0,transition:options.scaleTransition,restoreAfterFinish:!0})],Object.extend({beforeSetup:function(effect){with(Element)setStyle(effect.effects[0].element,{height:"0px"}),show(effect.effects[0].element)},afterFinishInternal:function(effect){with(Element)[undoClipping,undoPositioned].call(effect.effects[0].element),setStyle(effect.effects[0].element,oldStyle)}},options))}})},Effect.Shrink=function(element){element=$(element);var options=Object.extend({direction:"center",moveTransistion:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{}),oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:Element.getInlineOpacity(element)},dims=Element.getDimensions(element),moveX,moveY;switch(options.direction){case"top-left":moveX=moveY=0;break;case"top-right":moveX=dims.width,moveY=0;break;case"bottom-left":moveX=0,moveY=dims.height;break;case"bottom-right":moveX=dims.width,moveY=dims.height;break;case"center":moveX=dims.width/2,moveY=dims.height/2}return new Effect.Parallel([new Effect.Opacity(element,{sync:!0,to:0,from:1,transition:options.opacityTransition}),new Effect.Scale(element,window.opera?1:0,{sync:!0,transition:options.scaleTransition,restoreAfterFinish:!0}),new Effect.Move(element,{x:moveX,y:moveY,sync:!0,transition:options.moveTransition})],Object.extend({beforeStartInternal:function(effect){with(Element)[makePositioned,makeClipping].call(effect.effects[0].element)},afterFinishInternal:function(effect){with(Element)[hide,undoClipping,undoPositioned].call(effect.effects[0].element),setStyle(effect.effects[0].element,oldStyle)}},options))},Effect.Pulsate=function(e){e=$(e);var t=arguments[1]||{},n=Element.getInlineOpacity(e),r=t.transition||Effect.Transitions.sinoidal,i=function(e){return r(1-Effect.Transitions.pulse(e))};return i.bind(r),new Effect.Opacity(e,Object.extend(Object.extend({duration:3,from:0,afterFinishInternal:function(e){Element.setStyle(e.element,{opacity:n})}},t),{transition:i}))},Effect.Fold=function(element){element=$(element);var oldStyle={top:element.style.top,left:element.style.left,width:element.style.width,height:element.style.height};return Element.makeClipping(element),new Effect.Scale(element,5,Object.extend({scaleContent:!1,scaleX:!1,afterFinishInternal:function(effect){new Effect.Scale(element,1,{scaleContent:!1,scaleY:!1,afterFinishInternal:function(effect){with(Element)[hide,undoClipping].call(effect.element),setStyle(effect.element,oldStyle)}})}},arguments[1]||{}))};